% !Mode:: "TeX:UTF-8"
\chapter{绪论}

\section{简介}

\subsection{研究背景}

计算机视觉是计算机通过分析图像来获取图像中信息的能力，具有极其广泛的应用，如人脸识别、自动驾驶、视觉导航、医学影像分析等。计算机视觉领域的发展与人类生活的各个领域息息相关，而现如今，通过多样的机器学习技术提升计算机视觉系统的分析能力，成为当今计算机视觉研究领域亟待解决的问题。

对许多计算机视觉领域的经典任务而言，卷积神经网络（Convolutional Neural Networks, CNN）在多年的发展中取得了良好的成果。CNN针对网格式数据设计，在图片这样的矩阵型数据上具有很强的拟合能力，从而可以在很大程度上提取图像中像素级的信息和特征。因此，构建不同网络结构的CNN，并通过执行图像分类\cite{He2016DeepRL}等视觉任务，验证CNN提取特征的能力，一直以来都是本领域研究的热点。

\begin{figure}
    \centering
    \includegraphics[width=.8\textwidth]{figure/visual.png}
    \caption{本图中的办公桌上存在着多种物体间的语义关系}
    \label{fig:relation_sample}
\end{figure}

但是在目标检测\cite{Ren2015FasterRT}、区域分类\cite{Chen2018IterativeVR}、语义分割等任务中，图像中的物体在种类和数目上都较为复杂，物体间也具有多样化的关系。多样的物体种类和有限的数据使很多不常见的分类仅仅有很少的训练样例，还有严重遮挡、模糊等现象。而传统的视觉模型往往只对物体所在的局部区域进行分析，那么模型在这种较稀有分类上的表现就十分糟糕。如果模型能学习到图像的全局上下文信息，就可以借助其他常见分类与稀有分类间的关系，来提升模型在稀有分类上的表现。

在识别场景中的物体时，人类往往能通过多种关系来做出推理判断。如图\ref{fig:relation_sample}，这个办公桌的场景在生活中十分常见。当人一看到办公桌上的显示器，就会自动从记忆中调取信息，进而得知显示器附近会存在键盘、鼠标等物体。与人类很自然地通过常识性语义关系或空间关系辅助认知不同，传统的视觉模型缺少这样视觉推理的能力，也就是通过利用图像中的额外信息进行推理，增强视觉模型识别物体的能力。

本研究基于图像数据，构建图结构的知识图谱（Knowledge Graph, KG）来保存物体之间的关系。近年提出的图卷积网络（Graph Convolution Networks, GCN）可以有效提取图结构上的特征，并完成网络节点分类等任务\upcite{Kipf2017SemiSupervisedCW}。因此，本研究将通过GCN和知识图谱分析图像中物体间的关系信息，结合传统CNN对图像像素信息的提取能力，设计一种效率更高的新型视觉推理模型，以获得更好的区域分类效果，从而满足计算机视觉研究在自动驾驶等领域应用上的需求。

\subsection{相关理论}

本研究中利用了ResNet\cite{He2016DeepRL}、特征金字塔网络（Feature Pyramid Networks, FPN）\cite{Lin2017FeaturePN}、感兴趣区域（Region of Interest, RoI）层\cite{Girshick2015FastR,He2017MaskR}等技术。

\subsubsection{ResNet}

卷积神经网络针对网格型图像数据设计，广泛应用于计算机视觉领域，而随着多年以来卷积神经网络的发展与相应数据集的发展，ResNet\cite{He2016DeepRL}的提出极大地提升了卷积神经网络的特征提取能力。在传统的卷积神经网络中，层数更深可以使网络获得更好的非线性表达能力，但随着层数的加深，网络的收敛也变得愈发困难。这是因为由于网络较深，在网络反向传播时，经过多次计算的梯度很容易收敛到0，使该卷积核不被激活，参数不会再继续优化。因此，只有解决网络较深时的梯度丢失问题，才可以进一步提升卷积神经网络的特征提取能力。

ResNet提出了残差连接和瓶颈结构，两者皆可以用以构建更深更高效的卷积网络。前者可以解决在网络较深时出现的梯度丢失问题，后者则利用瓶颈结构使模型更小更高效。

\paragraph{残差连接} 在以往的卷积网络中，采用直接堆叠卷积核的方式加深网络，如著名的VGGNet\cite{Simonyan2015VeryDC}。而在深层网络中，往往会出现梯度丢失问题，即在过多层的梯度传导中，梯度降低至0，这导致加深网络的深度反而导致网路的性能下降。因此VGGNet等往往构建不到20层卷积核便达到了最高能力。但是，本研究意图赋予模型视觉推理能力的基础是充分提取图像的像素特征，而往往较深的网络才能有满足本研究所需的特征提取能力。

而ResNet解决了这一问题，其在每个卷积的构建单元中，对残差函数增加一个捷径分支来传导梯度，防止梯度在过多卷积层的传导中丢失。这使得加深卷积网络，如使用100层以上的网络时，网络的性能依然可以继续提升。

\begin{figure}[ht]
    \centering
    \includegraphics{figure/ResNet_building_block.eps}
    \caption{一个残差连接中的卷积构建单元}
    \label{fig:resnet_building_block}
\end{figure}

残差连接的捷径分支有多种连接方法，如投影、零填充和恒等连接。

\subparagraph{恒等连接} 等式(\ref{res:iden})代表一个卷积构建单元，其中$\mathbf{x}$代表输入的特征，，$\mathcal{F}$代表一个由卷积核构成的残差函数，往往由两层$3 \times 3$卷积层构建而成。而$W_{i}$为该构建单元中卷积核的权重。如图\ref{fig:resnet_building_block}。

\begin{equation} \label{res:iden}
    y = \mathcal{F} (\mathbf{x}, \{W_{i}\}) + \mathbf{x}.
\end{equation}

\subparagraph{投影连接} 等式(\ref{res:proj})中的$W_{s}$为一个线性的投影函数，一般使用$1 \times 1$卷积核来实现。线性体现在该卷积核后不会增加激活函数，而非线性激活操作会在完成加法运算后统一进行。

\begin{equation} \label{res:proj}
    y = \mathcal{F} (\mathbf{x}, \{W_{i}\}) + W_{s} \mathbf{x}.
\end{equation}

在实际应用中ResNet在对特征图进行降维时，每个卷积构建单元的输入和输出维度不同，此时使用恒等连接会使两个维度不一样的特征向量相加，造成错误。则应使用投影连接，将单个卷积构建单元中捷径分支的维度与残差分支，即卷积核主体的维度相统一。但此时，统一特征维度所使用的卷积操作为密集连接，一定程度上会增加模型的大小。相对来说，恒等连接不会增加模型的参数和计算的复杂度。因此在卷积构建单元无降维操作时，直接使用恒等连接是更优的选择。

如ResNet-101，101层的ResNet中仅存在5次降维操作，将ImageNet的图像输入尺寸由$224 \time 224$降维到$7 \times 7$，33个卷积构建单元组成的101层卷积网络仅存在5次投影连接，即模型的大部分残差连接都由恒等连接构建而成。

\subparagraph{零填充连接}  零填充连接是另一种在残差分支与捷径分支维度不同时的统一维度的方法。其直接在捷径分支的输出向量要增加的维度上填充0来匹配输出，但它的效果并不如投影连接好，仅作为在运算性能受限的情况下提供的一种构建选项。

\paragraph{瓶颈结构} 我们需要更深的网络来获得更好的特征提取能力的同时，模型的参数数量也需要控制，否则训练成本就会无限制地上升。

\begin{figure}[ht]
    \centering
    \includegraphics[width=.8\textwidth]{figure/ResNet_bottleneck.eps}
    \caption{瓶颈结构的残差函数$\mathcal{F}$（右图）}
    \label{fig:resnet_bottleneck}
\end{figure}

因此，ResNet提出了瓶颈结构（Bottleneck）作为网络的卷积构建单元。如图~\ref{fig:resnet_bottleneck}，对于每个残差函数$\mathcal{F}$，其使用了三个卷积层来代替原有的两层，分别使用$1 \times 1$、$3 \times 3$和$1 \times 1$卷积核，其中$1 \times 1$卷积核负责降低然后恢复维度，使$3 \times 3$卷积核作为“瓶颈”，可以具有较小的输入和输出，大大降低了模型的参数数量和运算成本。另外，经过实验证明，应用了瓶颈结构后，模型的准确率和运算速度双双提高。

无参数的恒等连接对于瓶颈结构尤为重要。如果在瓶颈结构中全使用投影连接，会导致模型的参数数量和运算成本翻倍。这是因为捷径连接到两个$1 \times 1$卷积核的高维端，较高的特征维度若使用$1 \times 1$卷积核这样较为密集的运算，就会带来巨大的运算成本。因此恒等连接和瓶颈结构是相辅相成的设计。

\subsubsection{特征金字塔网络}

本研究意图通过以知识图谱辅助的视觉推理，提升模型在稀少样本和小物体样本上的表现，但使用卷积网络对小物体样本进行充分的特征提取仍是重中之重。小物体样本的特点是在图像上难以辨别，分辨率极低，甚至在模型降低特征图大小后，占不到一个像素。如上文提到的ResNet组成的卷积网络主干，共有五次降维操作，输出特征图大小为原分辨率的$1/32$，这意味着分辨率在$32 \times 32$以下的小物体，最终在输出特征图中只占不到一个像素。如图\ref{fig:FPN_others:l}，一些传统的目标检测模型都是这样对小物体样本进行处理的\upcite{He2014SpatialPP,Girshick2015FastR}。这导致小物体在深层网络中的特征严重不足，位置信息也几乎完全丢失，这对小样本物体的分类带来了严重困扰。

\begin{figure}[ht]
    \centering
    \subfigure[单特征图输出]{
        \includegraphics[width=0.25\textwidth]{figure/FPN_single.png}
        \label{fig:FPN_others:l}
    }
    \subfigure[特征化图像金字塔]{
        \includegraphics[width=0.40\textwidth]{figure/FPN_imageP.png}
        \label{fig:FPN_others:m}
    }
    \subfigure[金字塔型的特征层级结构]{
        \includegraphics[width=0.25\textwidth]{figure/FPN_3.png}
        \label{fig:FPN_others:r}
    }
    \caption{一些以往的解决办法图示\upcite{Lin2017FeaturePN}}
    \label{fig:FPN_others}
\end{figure}

\paragraph{特征化图像金字塔} 最初，人们使用图像金字塔解决这一问题。如图\ref{fig:FPN_others:m}，其将输入图像手动下采样到多个分辨率，从大到小，然后对每个分辨率的图像都训练一个单独的卷积网络来提取特征，生成预测信息，最终再将预测信息融合。这样的方法直接而粗暴地利用了不同分辨率下的特征信息，各个分辨率的图像不再进行降维，在原分辨率图像所在的网络下，小物体所在区域没有被缩小，则小物体的识别自然会更加简单。但这样的网络存在着很多问题，首先是巨大的计算开销，大分辨率图像所用到的网络模型本来就大，何况还要训练多个网络。另外，同时使用多个卷积网络会耗费巨大的内存，在目前计算设备的内存没有发展时，这相当于限制了单个网络的质量。

\paragraph{金字塔型的特征层级结构} 一步式多目标检测器（Single Shot MultiBox Detector, SSD）\cite{Liu2016SSDSS}是第一个使用金字塔型的特征层级结构的网络。相对于图像金字塔，一步式多目标检测器可以对不同分辨率的特征图进行多次利用，在多个特征图分辨率下加入分类器并生成预测，如图\ref{fig:FPN_others:r}。这解决了图像金字塔网络的最大弊端，大大提升了运算速度。

由于网络在较低层次时，还没有充分地提取图像特征，虽然此时有很多高分辨率的信息，但是并不能正确地对物体进行识别，因此其没有直接利用单独的高分辨率特征进行分类预测。这也说明一步式多目标检测器在预测时并没有再次利用底层高分辨率的特征，导致其不具备增强小物体分类表现的能力。这一结构遇到了如下矛盾：在深层网络的低分辨率特征，小物体的特征图太小，无法识别；而低层网络的高分辨率特征，小物体的特征还没有被充分提取，识别效果依然很差。这导致这样的结构很难提升小样本情况下的分类准确率。

这是因为一步式多目标检测器并不是针对小样本识别的难题而设计，更多的，它想提升在目标检测任务上的整体表现，但它的金字塔型结构为后来的研究奠定了基础。

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.8\textwidth]{figure/FPN.png}
    \caption{FPN自底向上（左）和自顶向下（右）的传播路径\upcite{Lin2017FeaturePN}}
    \label{fig:FPN}
\end{figure}

\paragraph{特征金字塔结构} 特征金字塔网络解决了上文一步式多目标检测器遇到的问题。如图\ref{fig:FPN}，特征金字塔网络使用两部分分支，分别是自底向上（bottom-up）分支和自顶向下（top-down）分支。自底向上分支使用普通的卷积网络构建，它的作用就是逐层提取图像中的特征，越向上，特征提取的越完全。自顶向下分支使用了多层来自自底向上分支的特征，其连接使用$1 \times 1$卷积核实现，这可以使各个分辨率的特征更好地结合起来。而自顶向下分支中较高层的特征经过上采样后，与底层的特征使用加法操作相结合，这一步可以使底层的特征同时获得低层的高分辨率信息和高层的经过充分提取的特征信息。此时，低层特征才会生成新的预测，这样的预测就可以充分的利用各个分辨率的信息，大大提升模型对小样本的表现。特征金字塔网络的核心就是底层高分辨率特征是各个低层特征的结合，融合了多种信息，从而提升小样本的识别表现。

\subsubsection{感兴趣区域层}

\paragraph{RoI Pooling} 感兴趣区域池化层最早由Fast R-CNN\cite{Girshick2015FastR}提出，其目的是将任意大小的感兴趣区域通过最大池化（max pooling）转化成固定大小$H \times W$（如$7 \times 7$）的特征，以匹配后续全连接层的输出。在本研究中，感兴趣区域池化层用来提取对象区域的区域特征。

每一个感兴趣区域为四元组$(r, c, h, w)$，其中$(r, c)$为感兴趣区域左上角像素的坐标，$(h, w)$为感兴趣区域的长和宽。那么感兴趣区域的大小为$h \times w$。感兴趣区域池化层将$h \times w$的感兴趣区域等分成$H \times W$个窗口，则每个窗口的大小为$h / H \times w / W$。对每个窗口分别应用最大池化，得到$H \times W$个值，组合起来输出大小为$H \times W$的特征图。

但是在感兴趣区域池化层的运算过程中存在着一些量化操作，导致了计算出的区域特征和实际区域特征存在偏差。对大小为$h \times w$的感兴趣区域，其特征图大小可能因卷积网络主干的多次降维变为$h / 32 \times w / 32$，那么此时特征图的大小很可能不是整数，而感兴趣区域池化层直接对特征图坐标和大小的浮点数做了向下取整操作，这是第一次量化。另外，窗口的大小$h / H \times w / W$也可能不是整数，则此时还需要做一次取整操作，带来了第二次量化。这两次量化使区域的特征相对真实特征有小幅偏差，一定程度上影响了对物体的识别。

\paragraph{RoI Align} 随后，Mask R-CNN\cite{He2017MaskR}提出了感兴趣区域对齐层，对两次量化造成的误差做出了修正，提升了物体识别的精度。感兴趣区域对齐层不使用向下取整操作，而是直接使用精准的区域边界。由于输入的图像矩阵都是离散的，其使用了双线性插值法获取更精准的区域特征。此外，对每个区域，感兴趣区域对齐层使用了平均池化代替了最大池化。感兴趣区域对齐层相对感兴趣区域池化层取得了$3\%$的平均精度（mean AP）的绝对提升。

\section{国内外研究现状}

\subsection{视觉知识库}

计算机视觉领域的快速发展离不开公开大规模数据集的完善，从最简单的对物体对象的标注\cite{Lin2014MicrosoftCC, Russakovsky2015ImageNetLS}，到对场景信息的标注\cite{Zhou2018SemanticUO}，到对关系信息的标注\cite{Krishna2016VisualGC}等等。上述数据集的建立使依赖大量数据的卷积神经网络更易于训练，也间接定义了对卷积神经网络的评判标准。

ImageNet\cite{Russakovsky2015ImageNetLS}图像分类数据集的发布极大地促进了计算机视觉领域中深度学习方法的发展。作为图像分类数据集，ImageNet的标准输入分辨率为$224 \times 224 \times 3$，其中3代表图像的通道数，即红、绿、蓝三通道。ImageNet数据集的图像分类挑战任务具有1,000个分类，但ImageNet数据集本身已经发展到具有一千四百万张图像与超过两万个分类，并且也具备作为目标检测数据集的能力。微软发布的COCO\cite{Lin2014MicrosoftCC}数据集是计算机视觉领域中重要的具有一定规模的目标检测和语义分割数据集，其图像来自较为复杂的生活场景，输入分辨率不定。COCO数据集具有超过二十二万张经过标注的图像，对目标检测任务具有91类，对语义分割任务具有80类。Visual Genome\cite{Krishna2016VisualGC}数据集作为大范围目标检测数据集，包含了众多高质量的标注信息，包括对象信息、对象属性信息、对象间关系信息等。VG数据集由是十万余张经过高质量标注的图片样例组成，并具有超过八万个分类，平均每张图片中出现21.24个对象，17.68个关系连接以及16.08个属性标注信息。作为目标检测挑战任务，VG数据集可采样为具有一千类的vg-1000或具有三千类的vg-3000。

\subsection{利用关系信息的计算机视觉研究}

在深度学习成为计算机视觉的主流方法之前，已经有很多传统的视觉算法利用了对象间关系来提升算法表现。Divvala等的研究\cite{Divvala2009AnES}使用对象间的共存关系来对检测到的对象进行重新评分，从而提升目标检测的成绩，也有一些研究指出对象间的空间关系可以改善图像分割的效果\cite{Galleguillos2008ObjectCU, Gould2008MultiClassSW}。

随着深度学习在视觉领域的广泛应用，在目标检测，区域分类，语义分割等任务中，均有许多研究利用了关系信息来提升视觉任务的表现\cite{Hu2017RelationNF, Jiang2018HybridKR, Chen2018IterativeVR, Xu2019ReasoningRCNNUA}。

X.Chen等的超越卷积的迭代视觉推理系统\cite{Chen2018IterativeVR}（Iterative Visual Reasoning Beyond Convolutions）将区域间的空间关系和语义关系构建成图，并利用图神经网络进行分析。该系统由两个模块组成，局部模块（Local Module）和全局模块（Global Module）。局部模块主要使用空间内存（Spacial Memory）实现，可以提取图像中的像素级信息，全局模块则是基于图结构的关系推理。该模型在全局模块中通过有效利用人类常识性知识图谱来直接为语义关系提供参考，且显式地标识出区域与区域间的空间关系，更好地利用了这些关系信息。全局模块的处理方法利用了图神经网络的思想,其模块内的关系图主要由三个部分组成，区域图（Region Graph）、知识图（Knowledge Graph）和分配图（Assignment Graph）。其节点分为区域节点（Region Nodes）和类节点（Class Nodes），区域节点表示一图像中的某一区域，类节点表示在数据集中出现的每一种类别。

另外，最近有一些研究将知识图谱和图神经网络结合用于计算机视觉问题。Li等的研究\cite{Li2017SituationRW}提出了一种基于图神经网络的情景识别方法，可以有效地分析角色间的联合依赖关系。一些研究\cite{Wang2018ZeroShotRV, Kampffmeyer2019RethinkingKG}利用知识图谱来解决难度较高的零样本识别任务。Yang等的研究\cite{Yang2018VisualSN}提出了一个视觉导航框架，该框架可以动态地对知识图谱进行更新，结合语义关系使视觉导航可以更好地泛化到未见场景。

\subsection{图卷积网络}

图神经网络\cite{Scarselli2009TheGN}是对结构化数据进行特征提取的有效网络结构，根据传播方式的不同，可细化为图卷积网络等不同形态。图卷积网络中卷积的引入使运算更切合信息在拓扑结构上传播的本质，这类卷积运算分为频域（Spectral Domain）和空域（Spatial Domain）两种。基于频域运算的图卷积网络\cite{Bruna2014SpectralNA, Kipf2017SemiSupervisedCW}使用特殊构造的卷积核，对图进行傅里叶变换，从而在频域进行运算。基于空域的图卷积网络\cite{Duvenaud2015ConvolutionalNO,Atwood2016DiffusionConvolutionalNN}将卷积操作定义在节点上，直接对其近邻节点进行操作。

一种先进的图注意力网络\cite{Velickovic2018GraphAN}（Graph Attention Networks, GAT）在空域图卷积网络的基础上，受机器翻译中的联合学习\cite{Bahdanau2015NeuralMT}启发，引入了注意力机制，通过自注意力策略计算每个节点和其近邻节点的一种隐式表达，可以应用在具有任意度的图节点上。

\section{研究方法}

\subsection{研究目标}

本研究的主要目标是使用基于注意力机制的图卷积网络和人类常识性知识图谱，构建对物体语义关系的高效分析结构，结合传统的卷积网络骨架提取图像的像素特征，从而使模型具备视觉推理能力，提升在Visual Genome数据集上的区域分类任务的分类准确性。

\subsection{关键技术}

\subsubsection{知识图谱的构建}

本研究提出的视觉推理模型的关键之处在于使用图卷积网络分析知识图谱，利用知识图谱中的物体间关系来使模型具备视觉推理能力。而物体间关系的质量是视觉推理能力强弱的关键。物体间关系主要分为语义关系和空间关系，前者是图像之外的，物体和物体之间本身存在的关系信息，后者是图像内的，物体与物体之间的空间关系的信息。

语义关系的知识图谱通过两种方式构建。通过人类常识性的物体间关系在整个数据集中的出现频率，可以构建出关系知识图谱；通过物体的属性分布的相关度，可以构建出属性知识图谱。

空间关系的知识图谱可以通过简单的物体间距离构建，通过计算物体所在区域的中心间距离，来计算某图像内区域间的空间关系强弱程度。由于区域会出现重叠现象，还可以通过计算重叠区域间的交并比(IoU)来增强空间关系的强度。

\subsubsection{区域特征的提取与分配}

普通的卷积神经网络可以提取整张图像的像素特征，但区域分类任务要对图像中某一部分区域做识别，因此需要提取该区域的区域特征。在不同分辨率的图像中的大小不一的区域，经过特征提取后应得到结构通用、维度大小相同的特征，而普通的全连接层或卷积运算都不能满足这一需求。因此本研究使用感兴趣区域层，对图像中各个区域的特征进行提取。

经过感兴趣区域层提取区域特征之后，CNN模块输出的区域特征，很自然地应与GCN模块中知识图谱的节点相对应。由于知识图谱的节点实际上代表着某一种物体类别，则应使用由CNN模块生成的初步预测，来指导区域特征对节点的分配。而本模型事实上期望经过GCN模块的视觉推理能力，从而纠正CNN模块对某些区域错误的初始预测，这意味着在视觉推理能力生效时，CNN模块对这一区域生成的分类的初步预测的第一个一定是错误的，但正确的分类也有很大概率在初步预测的前$k$个。因此，本模型使用软分配策略分配区域特征，使错误预测的区域也有一部分特征被分配到正确的节点上。即使错误的初始分类会使正确的节点接收到较少的区域特征，但随着区域特征沿关系传播，正确的分类之间存在着关系，则正确节点的置信度会由此而提高，错误节点的置信度也会随之下降。因此，使用软分类策略可以使模型对错误的分类更加鲁棒，增强模型纠正初始预测错误的能力。

\subsubsection{区域特征的传播}

在GCN模块中，区域特征沿知识图谱的边进行传播，而对不同的边，基于频率统计的边权只能反映在数据集中这种关系出现次数的多少，但对出现关系的某一张图片而言，稀少的关系和频繁而常见的关系的关系强度是近似的。对单张图片样例而言，直接使用边权来作为传播特征的比例，并不能直接代表这二者在此张图上出现关系的强弱，只能间接地说明这张图上出现此关系的概率较低。但某张图片出现关系时，应对这样的关系加以利用。因此，本模型使用了带注意力机制的图注意力层来传播区域的特征，意图使用注意力机学习到为具备关系的节点间提供更强的权重，对不具备关系的节点间提供较低的权重。

另外，基于一个常识性假设，距离更近的物体间关系更强，而距离较远的物体间即使本身在语义上具备关系，在图像中可能只是凑巧同时出现，而不具备相应关系。那么对区域特征的传播加入距离权重为权重的分配提供了新的基于空间距离的先验知识，由此来削弱距离较远、凑巧出现的物体间关系。

\subsection{研究方法}

\subsubsection{对VG数据集的预处理和知识图谱构建}

VG数据集含有超过100,000张图像数据。在官方网站上下载VG数据集，依据数据集中定义的数据文件格式，对数据集文件进行分析。其中包含着如城市、野外、室内等不同场景下的高质量标注数据，应调查VG数据集对物体的标注情况和标注质量，选取合适的对象集合用以构建训练集和验证、测试集。

设计管理数据集的工具，对数据集进行再包装，将图像、对象区域位置信息、对象间关系信息、对象属性信息等使用简明的数据结构进行管理，将其中冗余的数据条目删除，保留在训练中使用到的或构建知识图谱过程中使用到的相应条目。使用VG数据集中提供的对象间关系信息和对象属性信息构建语义知识图谱。

\subsubsection{构建基线模型和加入了GCN模块的视觉推理模型}

本研究的视觉推理模型主要分为两大模块，分别为CNN模块与GCN模块。前者通过使用最新的目标检测框架技术，负责提取图像特征以及图像中的区域特征，后者使用图注意力层构建，负责使区域特征沿知识图谱的边进行传播。

本研究主要通过构建基线模型和上述视觉推理模型，在相同的训练参数和条件下，相同的数据集和任务下，对选定的评价指标进行对比，从而体现本研究所提出方法的有效性和优越性。

\section{论文构成}

论文除绪论外，主要由两大部分构成：第一大部分，介绍知识图谱的构建与视觉推理模型框架的设计思路；第二大部分，介绍视觉推理模型的实现细节，以及实验。

在第一大部分中，首先介绍CNN模块的设计思路，使其能够具备较好的区域分类能力，这可以增强基线模型的表现，也为视觉推理模型在GCN模块中利用关系打下良好基础。CNN模块中包含卷积网络主干、特征金字塔网络、感兴趣区域层等技术，CNN模块最终可以提取图像的区域特征，以及对各个区域分类的初始预测。

然后，介绍知识图谱的构建，根据关系来源的不同，主要分为语义知识图谱和空间知识图谱两类，其中语义知识图谱根据由对象间关系构造，或由对象间属性相关度构造，又分为关系知识图谱和属性知识图谱。本文详细地介绍了知识图谱的构建方法及思想。

最后，是视觉推理模型获得视觉推理模型的关键，GCN模块。在这一部分中，首先介绍了软分配策略，其决定了区域特征以怎样的方法对应到节点上，然后介绍普通图注意力层的设计思路，以及在本模型中，融合了知识图谱以及空间距离权重的图注意力层是怎么有效地传播正确地区域特征的。最后，介绍了GCN模块是如何对分类进行重新预测，从而更正错误的初始预测，并提升模型的分类准确率的。

在第二大部分中，首先介绍了本研究所针对的数据集，以及对数据集的预处理与在数据集上定义的区域分类任务；然后介绍了模型的训练参数等信息；最后，介绍了多组对比实验，从而分析本研究使用图注意力层在知识图谱上传播特征的有效性。

在全文最后，经过充分地讨论，得到了本研究的结论，以及本研究尚存在的一些不足，还包含对其未来改进空间的展望。